# 情報数学II チートシート

---

## 第1部: 数え上げと組み合わせ論

### 重要公式

* **二項係数:** $\displaystyle \binom{n}{k} = \frac{n!}{k!(n-k)!}$
* **二項係数の対称性:** $\displaystyle \binom{n}{k} = \binom{n}{n-k}$
* **二項係数の再帰的関係 (パスカルの三角形):** $\displaystyle \binom{n-1}{k-1} + \binom{n-1}{k} = \binom{n}{k}$
* **二項係数の和:** $\displaystyle \sum_{k=0}^{n}\binom{n}{k} = 2^n$
* **二項定理:** $(x+y)^n = \displaystyle \sum_{k=0}^{n}\binom{n}{k}x^k y^{n-k}$
* **ヴァンデルモンドの畳み込み:** $\displaystyle \sum_{k}\binom{r}{k}\binom{s}{n-k} = \binom{r+s}{n}$
* **フィボナッチ数の母関数:** $G(z) = \frac{z}{1-z-z^2}$
* **フィボナッチ数の一般項:** $F_n = \frac{1}{\sqrt{5}} \left[ \left(\frac{1+\sqrt{5}}{2}\right)^n - \left(\frac{1-\sqrt{5}}{2}\right)^n \right]$

### 主要アルゴリズム

* **摂動法:**
    和 $S_n = \sum_{k=0}^{n} a_k$ の閉じた形を求める手法。$S_{n+1}$ を $S_n + a_{n+1}$ と $a_0 + \sum_{k=0}^{n} a_{k+1}$ の2通りで表現し、得られた等式を $S_n$ について解く。

### 基本用語

* **階乗 (factorial):** $n! = 1 \times 2 \times \cdots \times n$。ただし、$0! = 1$ と定義される。
* **母関数 (generating function):** 数列 $\{a_n\}$ に対して、形式的べき級数 $A(z) = \sum_{n=0}^{\infty} a_n z^n$ をその数列の母関数という。漸化式を解く際に利用される。
* **畳み込み (convolution):** 2つの母関数 $F(z) = \sum f_n z^n$ と $G(z) = \sum g_n z^n$ の積 $F(z)G(z)$ は、数列の畳み込み $\{\sum_k f_k g_{n-k}\}$ の母関数となる。

---

## 第2部: 計算量の理論 (漸近記法)

### 重要公式

* **スターリングの近似公式:** $n! = \sqrt{2\pi n} \left(\frac{n}{e}\right)^n \left(1 + \Theta\left(\frac{1}{n}\right)\right)$

### 主要アルゴリズム

* **置き換え法 (substitution method):**
    漸化式の解の形を推測し、その推測が正しいことを数学的帰納法を用いて証明する手法。

### 基本用語

* **Big-O記法 ($O(g(n))$):** 関数の漸近的な**上限**を示す記法。ある正定数 $C$ と $n_0$ が存在し、全ての $n \ge n_0$ に対して $|f(n)| \le C|g(n)|$ が成り立つことを意味する。
* **Big-Ω記法 ($\Omega(g(n))$):** 関数の漸近的な**下限**を示す記法。ある正定数 $C$ と $n_0$ が存在し、全ての $n \ge n_0$ に対して $|f(n)| \ge C|g(n)|$ が成り立つことを意味する。
* **Θ記法 ($\Theta(g(n))$):** 関数の漸近的な挙動が上下から同じ関数オーダーで抑えられることを示す記法。「$f(n) = O(g(n))$」かつ「$f(n) = \Omega(g(n))$」が成り立つことを意味する。

---

## 第3部: グラフ理論

### 重要公式

* **握手補題:** 任意の無向グラフにおいて、全頂点の次数の総和は、辺の本数の2倍に等しい。
  $$ \sum_{v \in V} \deg(v) = 2|E| $$
* **木の特徴:** グラフ $G=(V,E)$ が木であることは、以下の条件と同値である。
  * 連結かつ閉路を持たない。
  * 連結であり、$|V| = |E| + 1$ を満たす。
  * 閉路を持たず、$|V| = |E| + 1$ を満たす。
* **証明のヒント:** 木に関する命題（例: $|V|=|E|+1$）の証明では、頂点数 $|V|$ に関する数学的帰納法が有効な場合が多い。特に、「任意の木（頂点数2以上）は、次数1の頂点（葉）を少なくとも1つ（多くの場合2つ）持つ」という性質を利用し、葉を1つ取り除いたグラフ（これも木になる）を考えることで、帰納法を適用できることがある。
* **オイラーの多面体公式:** 連結な平面的グラフの任意の平面描画において、頂点数を $|V|$、辺数を $|E|$、面数を $f$ とすると、$|V| - |E| + f = 2$ が成り立つ。
* **最大フロー最小カット定理:** ネットワークにおける最大フローの流量は、最小s-tカットの容量に等しい。

### 主要アルゴリズム

* **クラスカル法 (最小全域木):**
  1. グラフの全ての辺を重みが小さい順にソートする。
  2. 重みが小さい辺から順に、閉路を形成しない限りその辺を木に追加する。
  3. $|V|-1$ 本の辺が追加されるまで繰り返す。

* **Ford-Fulkerson法 (最大フロー):**
  1. 与えられたフローに対する残余グラフを構成する。
  2. 残余グラフ上にsからtへのパス（増加道）を見つける。
  3. 増加道がなければ終了。あれば、そのパスに沿ってフローを増やし、1に戻る。

### 基本用語

* **グラフ:** 頂点(vertex)の集合 $V$ と、頂点のペアを結ぶ辺(edge)の集合 $E$ からなる構造 $G=(V,E)$。
* **次数 (Degree):** 無向グラフにおいて、ある頂点に接続する辺の数。
* **入次数 (In-degree) / 出次数 (Out-degree):** 有向グラフにおいて、ある頂点に向かう辺の数（入次数）と、その頂点から出る辺の数（出次数）。
* **木 (Tree):** 連結で閉路(cycle)を持たないグラフ。
* **オイラー路/閉路 (Eulerian path/circuit):** グラフの全ての辺をちょうど一度だけ通る路/閉路。オイラー閉路を持つための必要十分条件は、グラフが連結かつ全頂点の次数が偶数であること。
* **グラフの同型 (Graph Isomorphism):** 2つのグラフ $G_1=(V_1,E_1)$ と $G_2=(V_2,E_2)$ が同型であるとは、頂点間の隣接関係を保つような全単射写像 $f:V_1 \to V_2$ が存在すること。直感的には、頂点のラベルを付け替えれば、2つのグラフの形（辺の接続構造）が完全に一致することを意味する。同型でないことを示すには、頂点数、辺数、次数の分布、閉路の数などが異なることを言えばよい。
* **s-tカット:** 頂点集合 $V$ を、$s \in S$ かつ $t \in T$ となるように2つの集合 $S$ と $T$ に分割すること。
* **マッチング:** どの2辺も頂点を共有しないような辺の集合。

---

## 第4部: 確率論の基礎と応用

### 重要公式

* **期待値 (Expected Value):** $E[X] = \sum_{x \in \mathcal{X}} x P_X(x)$
* **期待値の線形性:** 確率変数の和の期待値は、期待値の和に等しい。
  $$ E[X_1 + X_2 + \cdots + X_n] = E[X_1] + E[X_2] + \cdots + E[X_n] $$
* **分散 (Variance):** $Var[X] = E[(X - E[X])^2] = E[X^2] - (E[X])^2$
* **独立な確率変数の和の分散:**
  $$ Var[X_1 + X_2 + \cdots + X_n] = Var[X_1] + Var[X_2] + \cdots + Var[X_n] $$
* **和集合上界 (Union Bound):** $Pr[\cup_{i} A_i] \le \sum_i Pr[A_i]$
* **マルコフの不等式 (Markov's Inequality):** 非負の確率変数 $X$ と任意の $a > 0$ に対して、
  $$ Pr[X \ge a] \le \frac{E[X]}{a} $$
* **チェビシェフの不等式 (Chebyshev's Inequality):** 任意の $a > 0$ に対して、
  $$ Pr[|X - E[X]| \ge a] \le \frac{Var[X]}{a^2} $$

### 基本用語

* **二項分布:** 成功確率 $p$ の独立な試行を $n$ 回行うときの成功回数 $X$ の分布。期待値は $E[X]=np$、分散は $Var[X]=np(1-p)$。
* **幾何分布:** 成功確率 $p$ の独立な試行において、初めて成功するまでの試行回数 $X$ の分布。期待値は $E[X]=1/p$。
* **クーポンコレクター問題:** $n$ 種類のアイテムを全て集めるのに必要な試行回数の期待値は $n H_n$。ここで $H_n = \sum_{i=1}^n \frac{1}{i}$ は調和数。
* **ボールとビンのモデル:** $m$ 個のボールを $n$ 個のビンにランダムに投げ入れる確率モデル。ハッシュの衝突解析などに用いられる。
